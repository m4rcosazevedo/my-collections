import{i as f,g,k as y,r,l as h,j as l,C as E,m as S,h as p}from"./index-CXL-Htlo.js";import{u as U,P as w}from"./page-collection-item-add-or-update-eDNArDWC.js";import{u as x}from"./select-image-BKsk00jx.js";import{a as I,s as D}from"./price-wcI7WIqs.js";import"./type-service-DmLTmJmU.js";import"./yup-BLc_AR1d.js";import"./lazy-image-JYGuejRd.js";import"./title-X-0Xsvyv.js";import"./Button-BOkmu2B0.js";import"./Grid-CJ_-mJIa.js";class b{constructor(o,a){this.service=o,this.get=a}async getProduct(){const o=await this.get(this.service);if(!o.exists())throw new Error("Produto nÃ£o encontrado");return{id:o.id,...o.data()}}}const v=s=>new b(f(g,"products",s),y).getProduct(),A=s=>{const[o,a]=r.useState(!0),[i,t]=r.useState();return r.useEffect(()=>{a(!0),(async()=>{const n=await v(s);t(n),a(!1)})()},[s]),{product:i,loading:o}},V=()=>{const{uuid:s}=h(),o=U(),{reset:a,loading:i}=o,{product:t,loading:m}=A(s),[n,u]=r.useState(!1);r.useEffect(()=>{t&&!i&&a({name:t.name,image:null,imageUrl:t.image,type:t.type,platform:t.platform,amount:I(t.amount),status:t.status,classification:t.classification,description:t.description})},[a,t,i]);const d=async e=>{u(!0);try{let c=t==null?void 0:t.image;(e.imageUrl!==c||e.image)&&(c=await x({imageUrl:e.imageUrl,imageFile:e.image}));const P=f(g,"products",s);await S(P,{name:e.name,image:c,type:e.type,platform:e.platform,amount:D(e.amount),status:e.status,classification:e.classification,description:e.description}),p.success(e.name+" foi atualizado com sucesso!")}catch{p.error("Erro ao atualizar produto =(")}finally{u(!1)}};return[m,i,!n].every(e=>e)?l.jsx(E,{}):l.jsx(w,{defaultValues:o.DEFAULT_VALUES,onSubmit:d,title:`Editar o item: ${t==null?void 0:t.name}`,buttonStatus:!1,buttonText:n?"Atualizando...":"Editar",collectionItemHook:o,previewImage:t==null?void 0:t.image,uuid:s})};export{V as default};
