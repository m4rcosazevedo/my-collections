import{r as m,u as se,o as ae,b as te,j as e,B as M,d as w,I as h,F as g,p as E,S as L,q as re,t as ie,k as ne,h as le,i as P}from"./index-Du1HzC7E.js";import{c as me,d as de,e as ue}from"./type-service-Nny30_5X.js";import{u as oe,o as ce,C as d}from"./yup-CEkP0yVd.js";import{m as xe,L as he,M as V,R as fe}from"./lazy-image-DkA4Cq1M.js";import{T as pe}from"./title-D6TL38oO.js";import{S as je,s as ge,u as Se}from"./select-image-U5mJM32c.js";import{L as ye}from"./Link-BwmNhwrw.js";import{B as C}from"./Button-DWqUV6Gq.js";import{G as l}from"./Grid-C5jBk5oS.js";const Ie=o=>{const[f,c]=m.useState(!0),[p,i]=m.useState();return m.useEffect(()=>{c(!0),(async()=>{const a=await xe(o);i(a),c(!1)})()},[o]),{collection:p,loading:f}},W={name:"",image:null,imageUrl:"",type:"",platform:"",amount:"",status:"",classification:0,description:""},Le=()=>{const{control:o,handleSubmit:f,formState:{errors:c},watch:p,reset:i,setValue:S}=oe({defaultValues:W,resolver:ce(ae)}),{uuid:a}=se(),{collection:v,loading:y}=Ie(a),[T,x]=m.useState([]),[U,r]=m.useState([]),[I,j]=m.useState([]),[F,b]=m.useState(!1);return m.useEffect(()=>{b(!0),(async()=>(x(await me()),r(await de()),j(await ue()),b(!1)))()},[]),{control:o,watch:p,setValue:S,handleSubmit:f,errors:c,types:T,platforms:U,statuses:I,reset:i,DEFAULT_VALUES:W,loading:[F,y].every(Boolean),collection:v}},Pe=({onSubmit:o,title:f,buttonStatus:c,buttonText:p,collectionItemHook:{control:i,handleSubmit:S,errors:a,types:v,platforms:y,statuses:T,watch:x,setValue:U,collection:r},previewImage:I,uuid:j})=>{var O,R,$;const F=te(),[b,B]=m.useState(!1),[H,D]=m.useState(!0),[q,_]=m.useState([]),[A,G]=m.useState(),k=((O=r==null?void 0:r.filters)==null?void 0:O.includes("platforms"))??!1,J=((R=r==null?void 0:r.filters)==null?void 0:R.includes("types"))??!1,K=(($=r==null?void 0:r.filters)==null?void 0:$.includes("statuses"))??!1;m.useEffect(()=>{G(I)},[I]);const Q=async()=>{if(j&&window.confirm("Deseja realmente excluir este item?"))try{await ie(ne(le,"products",j)),P.success("Item excluído com sucesso!"),F(`/collection/${r==null?void 0:r.id}`)}catch{P.error("Erro ao excluir o item!")}},X=async()=>{var z;B(!0),D(!0);const t=x("name"),s=x("platform"),n=((z=y.find(({id:ee})=>ee===s))==null?void 0:z.name)??"",u=`${t} ${k?n:r==null?void 0:r.name}`,Z=await ge(u);_(Z),D(!1)},N=()=>B(!1),Y=async t=>{try{const s=await Se({imageUrl:t})??"";U("imageUrl",s),G(s),N()}catch{P.error("Erro ao selecionar imagem")}};return e.jsxs(M,{children:[e.jsx(pe,{children:f}),e.jsx(ye,{href:`/collection/${r==null?void 0:r.id}`,underline:"hover",children:e.jsx(C,{variant:"contained",color:"primary",size:"small",children:"Voltar"})}),e.jsxs(M,{component:"form",noValidate:!0,onSubmit:S(o),sx:{mt:3,width:"100%"},children:[e.jsx(d,{name:"collectionFilter",control:i,defaultValue:(r==null?void 0:r.filters)||"",render:({field:t})=>e.jsx("input",{type:"hidden",...t})}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(d,{name:"name",control:i,render:({field:t})=>{var s;return e.jsx(w,{id:"name",label:"Nome",...t,helperText:(s=a.name)==null?void 0:s.message,error:!!a.name})}})}),e.jsxs(l,{item:!0,xs:12,md:2,children:[A&&e.jsxs(e.Fragment,{children:[e.jsx(h,{children:"Imagem"}),e.jsx(he,{src:A,alt:"Imagem",width:150,height:150})]}),x("name")&&(k?x("platform"):!0)&&e.jsx(C,{variant:"contained",onClick:X,size:"small",children:"Buscar Imagem"})]}),e.jsxs(l,{item:!0,xs:12,md:10,children:[e.jsx(h,{children:"Upload de imagem"}),e.jsx("br",{}),e.jsxs(l,{children:[e.jsx(l,{item:!0,children:e.jsx(d,{name:"imageUrl",control:i,render:({field:t})=>{var s;return e.jsx(w,{id:"imageUrl",label:"Url da imagem",...t,helperText:(s=a.imageUrl)==null?void 0:s.message,error:!!a.imageUrl})}})}),e.jsx("br",{}),e.jsx(l,{item:!0,children:e.jsx(d,{name:"image",control:i,defaultValue:null,render:({field:t})=>{var s;return e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",onChange:n=>{n.target.files&&n.target.files.length>0&&t.onChange(n.target.files)}}),!!a.image&&e.jsx(g,{error:!0,children:(s=a.image)==null?void 0:s.message})]})}})})]})]}),J&&e.jsx(l,{item:!0,xs:12,children:e.jsx(d,{name:"type",control:i,render:({field:t})=>{var s;return e.jsxs(E,{fullWidth:!0,children:[e.jsx(h,{id:"select-type",children:"Selecionar Tipo"}),e.jsx(L,{...t,labelId:"select-type",label:"Selecionar Tipo",error:!!a.type,children:v.map(({id:n,name:u})=>e.jsx(V,{value:n,children:u},n))}),!!a.type&&e.jsx(g,{error:!0,children:(s=a.type)==null?void 0:s.message})]})}})}),k&&e.jsx(l,{item:!0,xs:12,children:e.jsx(d,{name:"platform",control:i,render:({field:t})=>{var s;return e.jsxs(E,{fullWidth:!0,children:[e.jsx(h,{id:"select-platform",children:"Selecionar Plataforma"}),e.jsx(L,{...t,labelId:"select-platform",label:"Selecionar Plataforma",error:!!a.platform,children:y.map(({id:n,name:u})=>e.jsx(V,{value:n,children:u},n))}),!!a.platform&&e.jsx(g,{error:!0,children:(s=a.platform)==null?void 0:s.message})]})}})}),K&&e.jsx(l,{item:!0,xs:12,children:e.jsx(d,{name:"status",control:i,render:({field:t})=>{var s;return e.jsxs(E,{fullWidth:!0,children:[e.jsx(h,{id:"select-status",children:"Selecionar Status"}),e.jsx(L,{...t,labelId:"select-status",label:"Selecionar Status",error:!!a.status,children:T.map(({id:n,name:u})=>e.jsx(V,{value:n,children:u},n))}),!!a.status&&e.jsx(g,{error:!0,children:(s=a.status)==null?void 0:s.message})]})}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(d,{name:"amount",control:i,defaultValue:"",render:({field:t})=>{var s;return e.jsx(re,{...t,inputRef:t.ref,id:"amount",label:"Preço",helperText:(s=a.amount)==null?void 0:s.message,error:!!a.amount})}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(d,{name:"description",control:i,render:({field:t})=>{var s;return e.jsx(w,{id:"description",label:"Descrição",...t,helperText:(s=a.description)==null?void 0:s.message,error:!!a.description})}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(d,{name:"classification",control:i,render:({field:t})=>{var s;return e.jsxs(e.Fragment,{children:[e.jsx(h,{id:"classification",children:"Classificação"}),e.jsx(fe,{...t}),!!a.classification&&e.jsx(g,{error:!0,children:(s=a.classification)==null?void 0:s.message})]})}})}),e.jsx(l,{item:!0,xs:12,children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(C,{variant:"contained",color:"primary",type:"submit",disabled:c,children:p}),j&&e.jsx(C,{variant:"contained",color:"error",onClick:Q,children:"Excluir"})]})})]})]}),e.jsx(je,{loading:H,open:b,images:q,onClose:N,onSelectImage:Y})]})};export{Pe as P,Le as u};
