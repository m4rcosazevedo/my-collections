import{b as U,r as p,j as c,C as E,f as b,g as h,h as I,i as f}from"./index-DSiCDo4C.js";import{u as P,P as S}from"./page-collection-item-add-or-update-BUsnFTB3.js";import{u as j}from"./select-image-DKXyOdpX.js";import{s as A}from"./price-wcI7WIqs.js";import"./type-service-BbVZSRKM.js";import"./yup-VDUYsaG9.js";import"./lazy-image-C2waQ_yY.js";import"./title-CuTYzyJG.js";import"./Link-DbYwmz_B.js";import"./Button-CZ8pnNLc.js";import"./Grid-BxbrYCOG.js";const O=()=>{const d=U(),[o,i]=p.useState(!1),r=P(),{collection:e,reset:a}=r;p.useEffect(()=>{e!=null&&e.filters&&a({collectionFilter:(e==null?void 0:e.filters)||""})},[e,a]);const g=async t=>{var m,n,u;i(!0);try{const l=await j({imageUrl:t.imageUrl,imageFile:t.image}),{collection:s}=r,C=((m=s==null?void 0:s.filters)==null?void 0:m.includes("platforms"))??!1,x=((n=s==null?void 0:s.filters)==null?void 0:n.includes("types"))??!1,y=((u=s==null?void 0:s.filters)==null?void 0:u.includes("statuses"))??!1;await b(h(I,"products"),{name:t.name,image:l,collection:s==null?void 0:s.id,amount:A(t.amount),classification:t.classification,description:t.description,...C&&{platform:t.platform}||{},...y&&{status:t.status}||{},...x&&{type:t.type}||{}}),f.success("Produto cadastrado com sucesso!"),d(`/collection/${s==null?void 0:s.id}`)}catch{f.error("Erro ao cadastrar produto")}finally{i(!1)}};return o?c.jsx(E,{}):c.jsx(S,{defaultValues:r.DEFAULT_VALUES,onSubmit:g,title:"Cadastrar novo item",buttonStatus:o,buttonText:o?"Cadastrando...":"Cadastrar",collectionItemHook:r})};export{O as default};
